<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Page Blocked</title>
    <link rel="stylesheet" href="/gui/extension-analysis.css">
</head>
<body>

<div class="logo-container">
    <img id="logo" src="" alt="Company Logo">
</div>

<h1 data-i18n="extension-analysis.block-page.page-blocked-header">Analyzing Extension</h1>

<div id="status">
    <span id="status-spinner" class="spinner"></span>
    <span id="status-text"></span>
    <br>
    <button data-i18n="extension-analysis.block-page.back" class="button" id="backButton" hidden>Back</button>
</div>

<div id="content" hidden>
    <img alt="extension logo" id="extension-logo" src="" hidden width="64" height="64">
    <span class="extension-name" id="extension-name"></span>

    <div class="risk-indicator-row">
        <div class="risk-indicator" id="risk-global"></div>
        <div class="risk-indicator" id="risk-impact"></div>
        <div class="risk-indicator" id="risk-likelihood"></div>
    </div>

    <div id="installSection">
        <button data-i18n="extension-analysis.block-page.install" class="button" id="installButton" disabled>Install</button>
        <p>
        <div id="blockedSection"></div>
    </div>

    <div>
        <span class="risk-details-header" data-i18n="extension-analysis.block-page.details.header">Extension Details</span>

        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.details.id">Extension Id</span>:
            <span class="risk-details-value" id="extension-id"></span>
        </p>
        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.details.category">Category</span>:
            <span class="risk-details-value" id="extension-category"></span>
        </p>
    </div>

    <div>
        <span class="risk-details-header" data-i18n="extension-analysis.block-page.likelihood.header">Risk Likelihood</span>

        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.likelihood.verified-extension">Verified Extension</span>:
            <span class="risk-details-value" id="risk-value-verified-extension"></span>
        </p>
        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.likelihood.verified-publisher">Verified Publisher</span>:
            <span class="risk-details-value" id="risk-value-verified-publisher"></span>
        </p>
        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.likelihood.downloads">Downloads</span>:
            <span class="risk-details-value" id="risk-value-downloads"></span>
        </p>
        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.likelihood.rating">Rating</span>:
            <span class="risk-details-value">
            <span id="risk-value-rating"></span>
            (<span id="risk-value-ratings"></span> <span data-i18n="extension-analysis.block-page.likelihood.ratings"></span>)
        </span>
        </p>
        <p>
            <span class="risk-details-label" data-i18n="extension-analysis.block-page.likelihood.manifest">Manifest</span>:
            <span class="risk-details-value" id="risk-value-manifest"></span>
        </p>
    </div>

    <div>
        <span class="risk-details-header" data-i18n="extension-analysis.block-page.impact.header">Risk Impact</span>

        <table>
            <thead>
            <tr>
                <th data-i18n="extension-analysis.block-page.impact.perm-header-name">Permission Name</th>
                <th data-i18n="extension-analysis.block-page.impact.perm-header-desc">Description</th>
                <th data-i18n="extension-analysis.block-page.impact.perm-header-risk">Risk</th>
            </tr>
            </thead>
            <tbody id="permissions"></tbody>
        </table>
    </div>
</div>

<p id="exceptionSectionToggle" data-i18n-html="extension-analysis.block-page.request-exception" hidden>If you are <b><u>sure</u></b> the extension does not represent a security risk you can <span id="clickable">request an exception</span></p>

<div class="centered" id="exceptionSection" hidden>
    <label for="exceptionReason" data-i18n="extension-analysis.block-page.request-exception-header" class="exception-request-header">Request an Exception</label>
    <textarea id="exceptionReason" data-i18n="extension-analysis.block-page.provide-reason" placeholder="Please provide your reason for requesting an exception"></textarea>
    <button id="submitException" data-i18n="extension-analysis.block-page.submit-request">Submit Request</button>
</div>


<script src="/utils/utils.js"></script>
<script src="/utils/definitions.js"></script>
<script src="/utils/browser.js"></script>
<script src="/utils/unzipit.js"></script>
<script src="/utils/injected/citadel-content-script-utils.js"></script>
<script src="/utils/persistence.js"></script>
<script src="/utils/tab-state.js"></script>
<script src="/utils/i18n/i18n.js"></script>
<script src="/utils/trust/extension/acorn.js"></script>
<script src="/utils/trust/extension/acorn-walk.js"></script>
<script src="/utils/trust/extension/extension.js"></script>
<script src="/utils/trust/extension/extension-store.js"></script>
<script src="/utils/trust/extension/extension-analysis.js"></script>
<script src="/gui/utils.js"></script>
<script src="/gui/extension-analysis.js"></script>
</body>
</html>