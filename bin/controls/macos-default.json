{
  "controls": {
    "BrowserUpdated": {
      "text": {
        "en": {
          "label": "Browser is updated",
          "explain": "https://www.citadelagent.org/control/BrowserUpdated"
        },
        "fr": {
          "label": "Navigateur est à jour",
          "explain": "https://www.citadelagent.org/control/BrowserUpdated"
        }
      }
    },
    "ForbiddenApplications": {
      "text": {
        "en": {
          "label": "No forbidden applications installed",
          "explain": "https://www.citadelagent.org/control/ForbiddenApplications"
        },
        "fr": {
          "label": "Aucune application interdite installée",
          "explain": "https://www.citadelagent.org/control/ForbiddenApplications"
        }
      }
    },
    "MissingApplications": {
      "text": {
        "en": {
          "label": "All required applications installed",
          "explain": "https://www.citadelagent.org/control/MissingApplications"
        },
        "fr": {
          "label": "Toutes applications requises installées",
          "explain": "https://www.citadelagent.org/control/MissingApplications"
        }
      }
    },
    "ForbiddenProcesses": {
      "text": {
        "en": {
          "label": "No forbidden processes running",
          "explain": "https://www.citadelagent.org/control/ForbiddenProcesses"
        },
        "fr": {
          "label": "Aucun processus interdit actif",
          "explain": "https://www.citadelagent.org/control/ForbiddenProcesses"
        }
      }
    },
    "MissingProcesses": {
      "text": {
        "en": {
          "label": "All required processes running",
          "explain": "https://www.citadelagent.org/control/MissingProcesses"
        },
        "fr": {
          "label": "Tous processus requis actifs",
          "explain": "https://www.citadelagent.org/control/MissingProcesses"
        }
      }
    },
    "MaxUptime": {
      "query": "SELECT '' AS error FROM uptime WHERE total_seconds / 60 / 60 / 24 > 30;",
      "text": {
        "en": {
          "label": "System was restarted recently",
          "explain": "https://www.citadelagent.org/control/MaxUptime"
        },
        "fr": {
          "label": "Système a été redémarré récemment",
          "explain": "https://www.citadelagent.org/control/MaxUptime"
        }
      }
    },
    "SystemUpdated": {
      "text": {
        "en": {
          "label": "System is up to date",
          "explain": "https://www.citadelagent.org/control/SystemUpdated"
        },
        "fr": {
          "label": "Système à jour",
          "explain": "https://www.citadelagent.org/control/SystemUpdated"
        }
      }
    },
    "DriveEncryption": {
      "query": "SELECT '' AS error FROM disk_encryption WHERE name = '/' AND encrypted != '1';",
      "text": {
        "en": {
          "label": "Disk is encrypted",
          "explain": "https://www.citadelagent.org/control/DriveEncryption"
        },
        "fr": {
          "label": "Disque est chiffré",
          "explain": "https://www.citadelagent.org/control/DriveEncryption"
        }
      }
    },
    "LockScreen": {
      "query": "SELECT 'askForPassword is NOT set' AS error FROM preferences WHERE domain = 'com.apple.screensaver' AND key = 'askForPassword' AND value != 1\nUNION ALL\nSELECT 'askForPasswordDelay too high: ' || value AS error FROM preferences WHERE domain = 'com.apple.screensaver' AND key = 'askForPasswordDelay' AND CAST(value AS INTEGER) > 600;",
      "text": {
        "en": {
          "label": "Screen locking is enabled",
          "explain": "https://www.citadelagent.org/control/LockScreen"
        },
        "fr": {
          "label": "Verrouillage écran activé",
          "explain": "https://www.citadelagent.org/control/LockScreen"
        }
      }
    },
    "SystemIntegrityProtection": {
      "query": "SELECT 'SIP flag ' || CAST(config_flag AS TEXT) || ' is enabled' AS error FROM sip_config WHERE config_flag == 1;",
      "text": {
        "en": {
          "label": "System Integrity Protection is enabled",
          "explain": "https://www.citadelagent.org/control/SystemIntegrityProtection"
        },
        "fr": {
          "label": "Protection Intégrité du Système (SIP) activée",
          "explain": "https://www.citadelagent.org/control/SystemIntegrityProtection"
        }
      }
    },
    "Firewall": {
      "query": "SELECT '' AS error FROM alf WHERE global_state == 0;",
      "text": {
        "en": {
          "label": "Firewall is enabled",
          "explain": "https://www.citadelagent.org/control/Firewall"
        },
        "fr": {
          "label": "Pare-feu activé",
          "explain": "https://www.citadelagent.org/control/Firewall"
        }
      }
    },
    "GatekeeperEnabled": {
      "query": "SELECT '' AS error FROM gatekeeper WHERE assessments_enabled != 1;",
      "text": {
        "en": {
          "label": "Gatekeeper is enabled",
          "explain": "https://www.citadelagent.org/control/GatekeeperEnabled"
        },
        "fr": {
          "label": "Gatekeeper activé",
          "explain": "https://www.citadelagent.org/control/GatekeeperEnabled"
        }
      }
    },
    "AutoUpdates": {
      "query": "SELECT '' AS error FROM preferences WHERE domain='com.apple.SoftwareUpdate' AND key='AutomaticCheckEnabled' AND value != 1;",
      "text": {
        "en": {
          "label": "Automatic updates are enabled",
          "explain": "https://www.citadelagent.org/control/AutoUpdates"
        },
        "fr": {
          "label": "Mises à jour automatiques activées",
          "explain": "https://www.citadelagent.org/control/AutoUpdates"
        }
      }
    },
    "SharingPreferences": {
      "query": "SELECT 'Screen Sharing is enabled' AS error FROM sharing_preferences WHERE screen_sharing = 1\nUNION ALL\nSELECT 'File Sharing is enabled' FROM sharing_preferences WHERE file_sharing = 1\nUNION ALL\nSELECT 'Printer Sharing is enabled' FROM sharing_preferences WHERE printer_sharing = 1\nUNION ALL\nSELECT 'Remote Login (SSH) is enabled' FROM sharing_preferences WHERE remote_login = 1\nUNION ALL\nSELECT 'Remote Management is enabled' FROM sharing_preferences WHERE remote_management = 1\nUNION ALL\nSELECT 'Remote Apple Events is enabled' FROM sharing_preferences WHERE remote_apple_events = 1\nUNION ALL\nSELECT 'Internet Sharing is enabled' FROM sharing_preferences WHERE internet_sharing = 1\nUNION ALL\nSELECT 'Bluetooth Sharing is enabled' FROM sharing_preferences WHERE bluetooth_sharing = 1\nUNION ALL\nSELECT 'Content Caching is enabled' FROM sharing_preferences WHERE content_caching = 1;",
      "text": {
        "en": {
          "label": "Sharing services are disabled",
          "explain": "https://www.citadelagent.org/control/SharingPreferences"
        },
        "fr": {
          "label": "Services de partage sont désactivés",
          "explain": "https://www.citadelagent.org/control/SharingPreferences"
        }
      }
    },
    "GuestLogin": {
      "query": "SELECT '' AS error FROM plist WHERE path = '/Library/Preferences/com.apple.loginwindow.plist' AND key = 'GuestEnabled' AND value = 1;",
      "text": {
        "en": {
          "label": "Guest login is disabled",
          "explain": "https://www.citadelagent.org/control/GuestLogin"
        },
        "fr": {
          "label": "Session Invité désactivée",
          "explain": "https://www.citadelagent.org/control/GuestLogin"
        }
      }
    },
    "SSHKeys": {
      "query": "SELECT path AS error FROM user_ssh_keys WHERE encrypted = 0;",
      "text": {
        "en": {
          "label": "SSH private keys are secured",
          "explain": "https://www.citadelagent.org/control/SSHKeys"
        },
        "fr": {
          "label": "Clés privées SSH sécurisées",
          "explain": "https://www.citadelagent.org/control/SSHKeys"
        }
      }
    },
    "BootOptions": {
      "query": "SELECT name || ' is set to ' || value AS error\nFROM nvram \nWHERE (name = 'csr-active-config' AND value != '0') OR \n   (name = 'boot-args' AND (\n    value LIKE '%amfi=0x0%' OR \n    value LIKE '%amfi_get_out_of_my_way=1%' OR\n    value LIKE '%amfi_allow_any_signature=1%' OR\n    value LIKE '%amfi_allow_expired_certs=1%' OR\n    value LIKE '%amfi_allow_invalid_signature=1%' OR\n    value LIKE '%amfi_check_dyld=0%' OR\n    value LIKE '%amfi_unrestrict_task_for_pid=1%' OR\n    value LIKE '%amfi_verify_csignatures=0%'\n  ));;",
      "text": {
        "en": {
          "label": "Boot options are secure",
          "explain": "https://www.citadelagent.org/control/BootOptions"
        },
        "fr": {
          "label": "Options démarrage sécurisées",
          "explain": "https://www.citadelagent.org/control/BootOptions"
        }
      }
    },
    "WirelessNetworking": {
      "query": "SELECT '\"' || network_name || '\" uses insecure protocol: ' || security_type AS error FROM wifi_status WHERE security_type IN ('Personal', 'WEP', 'Open', 'Dynamic WEP', 'WPA Personal', 'WPA Personal Mixed', 'WPA Enterprise');",
      "text": {
        "en": {
          "label": "No insecure wireless networks",
          "explain": "https://www.citadelagent.org/control/WirelessNetworking"
        },
        "fr": {
          "label": "Aucun réseau sans fil non sécurisé",
          "explain": "https://www.citadelagent.org/control/WirelessNetworking"
        }
      }
    },
    "RemovableStorage": {
      "query": "SELECT vendor || ' ' || model || ' (' || serial || ')' AS error FROM usb_devices WHERE class = 8 AND removable = 1;",
      "text": {
        "en": {
          "label": "No USB storage devices connected",
          "explain": "https://www.citadelagent.org/control/RemovableStorage"
        },
        "fr": {
          "label": "Aucun périphérique de stockage USB",
          "explain": "https://www.citadelagent.org/control/RemovableStorage"
        }
      }
    },
    "SensitiveFiles": {
      "query": "SELECT replace(path, '/Users/{{username}}/', '') AS error FROM file WHERE directory = '/Users/{{username}}/Downloads' AND (filename LIKE '%password%emergency%kit.pdf' OR filename LIKE '%backup%code%' OR filename LIKE '%recovery%code%' OR filename LIKE '%password%') AND btime <= (strftime('%s','now') - (7 * 24 * 60 * 60));",
      "text": {
        "en": {
          "label": "Sensitive data is protected",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        },
        "fr": {
          "label": "Données sensibles sont protégés",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        }
      }
    },
    "ExportedFiles": {
      "query": "SELECT replace(path, '/Users/{{username}}/', '') AS error FROM file WHERE directory = '/Users/{{username}}/Downloads' AND (filename LIKE '%export%.csv' OR filename LIKE '%export%.json' OR filename LIKE '%export%.txt' OR filename LIKE '%export%.xls' OR filename LIKE '%export%.xlsx') AND btime <= (strftime('%s','now') - (30 * 24 * 60 * 60));",
      "text": {
        "en": {
          "label": "Exported files are purged",
          "explain": "https://www.citadelagent.org/control/ExportedFiles"
        },
        "fr": {
          "label": "Fichiers exportés sont supprimés",
          "explain": "https://www.citadelagent.org/control/ExportedFiles"
        }
      }
    },
    "UnusedFiles": {
      "query": "SELECT \n  replace(path, '/Users/{{username}}/', '') AS error \nFROM file \nWHERE path LIKE '/Users/{{username}}/Downloads/%' \n  AND btime <= (strftime('%s','now') - (90 * 24 * 60 * 60));",
      "text": {
        "en": {
          "label": "Unused files are purged",
          "explain": "https://www.citadelagent.org/control/UnusedFiles"
        },
        "fr": {
          "label": "Fichiers inutilisés sont supprimés",
          "explain": "https://www.citadelagent.org/control/UnusedFiles"
        }
      }
    }
  }
}