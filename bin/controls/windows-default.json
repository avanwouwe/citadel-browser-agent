{
  "controls": {
    "BrowserUpdated": {
      "text": {
        "en": {
          "label": "Browser is updated",
          "explain": "https://www.citadelagent.org/control/BrowserUpdated"
        },
        "fr": {
          "label": "Navigateur est à jour",
          "explain": "https://www.citadelagent.org/control/BrowserUpdated"
        }
      }
    },
    "ForbiddenApplications": {
      "text": {
        "en": {
          "label": "No forbidden applications installed",
          "explain": "https://www.citadelagent.org/control/ForbiddenApplications"
        },
        "fr": {
          "label": "Aucune application interdite installée",
          "explain": "https://www.citadelagent.org/control/ForbiddenApplications"
        }
      }
    },
    "MissingApplications": {
      "text": {
        "en": {
          "label": "All required applications installed",
          "explain": "https://www.citadelagent.org/control/MissingApplications"
        },
        "fr": {
          "label": "Toutes les applications requises installées",
          "explain": "https://www.citadelagent.org/control/MissingApplications"
        }
      }
    },
    "ForbiddenProcesses": {
      "text": {
        "en": {
          "label": "No forbidden processes running",
          "explain": "https://www.citadelagent.org/control/ForbiddenProcesses"
        },
        "fr": {
          "label": "Aucun processus interdit actif",
          "explain": "https://www.citadelagent.org/control/ForbiddenProcesses"
        }
      }
    },
    "MissingProcesses": {
      "text": {
        "en": {
          "label": "All required processes running",
          "explain": "https://www.citadelagent.org/control/MissingProcesses"
        },
        "fr": {
          "label": "Tous les processus requis sont actifs",
          "explain": "https://www.citadelagent.org/control/MissingProcesses"
        }
      }
    },
    "MaxUptime": {
      "query": "SELECT '' AS error FROM uptime WHERE total_seconds / 60 / 60 / 24 > 30;",
      "text": {
        "en": {
          "label": "System was restarted recently",
          "explain": "https://www.citadelagent.org/control/MaxUptime"
        },
        "fr": {
          "label": "Système a été redémarré récemment",
          "explain": "https://www.citadelagent.org/control/MaxUptime"
        }
      }
    },
    "SystemUpdated": {
      "text": {
        "en": {
          "label": "System is up to date",
          "explain": "https://www.citadelagent.org/control/SystemUpdated"
        },
        "fr": {
          "label": "Système est à jour",
          "explain": "https://www.citadelagent.org/control/SystemUpdated"
        }
      }
    },
    "DriveEncryption": {
      "query": "SELECT '' AS error FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\BitlockerStatus\\BootStatus' AND data != '1';",
      "text": {
        "en": {
          "label": "Disk is encrypted",
          "explain": "https://www.citadelagent.org/control/DriveEncryption"
        },
        "fr": {
          "label": "Disque est chiffré",
          "explain": "https://www.citadelagent.org/control/DriveEncryption"
        }
      }
    },
    "LockScreen": {
      "query": "SELECT 'Screen lock not required on resume' AS error FROM registry WHERE path = 'HKEY_CURRENT_USER\\Control Panel\\Desktop\\ScreenSaverIsSecure' AND data != '1'\nUNION ALL\nSELECT 'Screen lock timeout too high: ' || data AS error FROM registry WHERE path = 'HKEY_CURRENT_USER\\Control Panel\\Desktop\\ScreenSaveTimeOut' AND CAST(data AS INTEGER) > 600\nUNION ALL\nSELECT 'Screen lock disabled' AS error FROM registry WHERE path = 'HKEY_CURRENT_USER\\Control Panel\\Desktop\\ScreenSaveActive' AND data != '1'\nUNION ALL\nSELECT 'No screen saver program specified' AS error \nWHERE NOT EXISTS (\n  SELECT 1 \n  FROM registry \n  WHERE path = 'HKEY_CURRENT_USER\\Control Panel\\Desktop\\SCRNSAVE.EXE' \n);",
      "text": {
        "en": {
          "label": "Screen locking is enabled",
          "explain": "https://www.citadelagent.org/control/LockScreen"
        },
        "fr": {
          "label": "Verrouillage de l'écran est activé",
          "explain": "https://www.citadelagent.org/control/LockScreen"
        }
      }
    },
    "Firewall": {
      "query": "SELECT '' AS error FROM windows_security_center WHERE firewall != 'Good';",
      "text": {
        "en": {
          "label": "Firewall is enabled",
          "explain": "https://www.citadelagent.org/control/Firewall"
        },
        "fr": {
          "label": "Pare-feu est activé",
          "explain": "https://www.citadelagent.org/control/Firewall"
        }
      }
    },
    "ProtectionStatus": {
      "query": "SELECT 'internet settings = ' || internet_settings AS error FROM windows_security_center WHERE internet_settings != 'Good'\nUNION ALL\nSELECT 'Windows Security Center = ' || windows_security_center_service AS error FROM windows_security_center WHERE windows_security_center_service != 'Good'\nUNION ALL\nSELECT 'User Account Control = ' || user_account_control AS error FROM windows_security_center WHERE user_account_control != 'Good';",
      "text": {
        "en": {
          "label": "Windows Security Centre features are active",
          "explain": "https://www.citadelagent.org/control/ProtectionStatus"
        },
        "fr": {
          "label": "Fonctionnalités Windows Security Centre sont activées",
          "explain": "https://www.citadelagent.org/control/ProtectionStatus"
        }
      }
    },
    "AutoUpdates": {
      "query": "SELECT 'AUOptions = ' || data AS error\nFROM (\n  SELECT\n    CASE\n      WHEN policies.name IS NOT NULL THEN policies.data\n      ELSE normal.data\n    END AS data\n  FROM\n    (\n      SELECT name,data FROM registry\n      WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\AUOptions'\n    ) AS policies\n  FULL OUTER JOIN\n    (\n\t\t  SELECT name,data FROM registry\n\t\t  WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update\\AUOptions'\n    ) AS normal\n  ON 1=1\n) AS update_policy\nWHERE CAST(data AS INTEGER) < 4\n\nUNION ALL \n\nSELECT 'NoAutoUpdate = ' || data AS error\nFROM registry\nWHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\NoAutoUpdate' AND data = '1'\n\nUNION ALL\n\nSELECT 'Windows Update service = ' || status AS error\nFROM services\nWHERE name = 'wuauserv' AND status != 'RUNNING';",
      "text": {
        "en": {
          "label": "Automatic updates are enabled",
          "explain": "https://www.citadelagent.org/control/AutoUpdates"
        },
        "fr": {
          "label": "Mises à jour automatiques sont activées",
          "explain": "https://www.citadelagent.org/control/AutoUpdates"
        }
      }
    },
    "Antivirus": {
      "query": "SELECT '' AS error FROM windows_security_center WHERE antivirus != 'Good'",
      "text": {
        "en": {
          "label": "Antivirus protection is enabled",
          "explain": "https://www.citadelagent.org/control/Antivirus"
        },
        "fr": {
          "label": "Protection antivirus est activée",
          "explain": "https://www.citadelagent.org/control/Antivirus"
        }
      }
    },
    "SharingPreferences": {
      "query": "SELECT 'Remote Desktop is enabled' AS error FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections' AND data = '0'\nUNION ALL\nSELECT 'File and Printer Sharing is enabled' FROM services WHERE name = 'LanmanServer' AND start_type != 'DISABLED'\nUNION ALL\nSELECT 'Remote Registry is enabled' FROM services WHERE name = 'RemoteRegistry' AND start_type != 'DISABLED';",
      "text": {
        "en": {
          "label": "Sharing services are disabled",
          "explain": "https://www.citadelagent.org/control/SharingPreferences"
        },
        "fr": {
          "label": "Services de partage sont désactivés",
          "explain": "https://www.citadelagent.org/control/SharingPreferences"
        }
      }
    },
    "SSHKeys": {
      "query": "SELECT path AS error FROM user_ssh_keys WHERE encrypted = 0;",
      "text": {
        "en": {
          "label": "SSH private keys are secured",
          "explain": "https://www.citadelagent.org/control/SSHKeys"
        },
        "fr": {
          "label": "Clés privées SSH sont sécurisées",
          "explain": "https://www.citadelagent.org/control/SSHKeys"
        }
      }
    },
    "BootOptions": {
      "query": "SELECT 'UEFI secure boot is disabled' AS error FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\\State\\UEFISecureBootEnabled' AND data != 1;",
      "text": {
        "en": {
          "label": "Boot options are secure",
          "explain": "https://www.citadelagent.org/control/BootOptions"
        },
        "fr": {
          "label": "Options de démarrage sont sécurisées",
          "explain": "https://www.citadelagent.org/control/BootOptions"
        }
      }
    },
    "RemovableStorage": {
      "query": "SELECT device_id AS error FROM logical_drives WHERE description LIKE '%removable%';",
      "text": {
        "en": {
          "label": "No USB storage devices",
          "explain": "https://www.citadelagent.org/control/RemovableStorage"
        },
        "fr": {
          "label": "Aucun périphérique de stockage USB",
          "explain": "https://www.citadelagent.org/control/RemovableStorage"
        }
      }
    },
    "SensitiveFiles": {
      "query": "SELECT replace(path, 'C:\\\\Users\\\\{{username}}\\\\', '') AS error FROM file WHERE directory = 'C:\\\\Users\\\\{{username}}\\\\Downloads' AND (filename LIKE '%backup%code%' OR filename LIKE '%recovery%code%' OR filename LIKE '%password%') AND btime <= (strftime('%s','now') - (7 * 24 * 60 * 60));",
      "text": {
        "en": {
          "label": "Sensitive data is protected",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        },
        "fr": {
          "label": "Données sensibles sont protégés",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        }
      }
    },
    "ExportedFiles": {
      "query": "SELECT replace(path, 'C:\\\\Users\\\\{{username}}\\\\', '') AS error FROM file WHERE directory = 'C:\\\\Users\\\\{{username}}\\\\Downloads' AND (filename LIKE '%export%.csv' OR filename LIKE '%export%.json' OR filename LIKE '%export%.txt' OR filename LIKE '%export%.xls' OR filename LIKE '%export%.xlsx') AND btime <= (strftime('%s','now') - (30 * 24 * 60 * 60));",
      "text": {
        "en": {
          "label": "Exported files are purged",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        },
        "fr": {
          "label": "Fichiers exportés sont supprimés",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        }
      }
    },
    "UnusedFiles": {
      "query": "SELECT replace(path, 'C:\\\\Users\\\\{{username}}\\\\', '') AS error FROM file WHERE directory = 'C:\\\\Users\\\\{{username}}\\\\Downloads' AND btime <= (strftime('%s','now') - (90 * 24 * 60 * 60));",
      "text": {
        "en": {
          "label": "Unused files are purged",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        },
        "fr": {
          "label": "Fichiers inutilisés sont supprimés",
          "explain": "https://www.citadelagent.org/control/SensitiveFiles"
        }
      }
    }
  }
}